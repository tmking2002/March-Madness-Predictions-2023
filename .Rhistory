list.files()
list.files("~/data")
setwd("data")
list.files("data")
setwd("~/Projects/2023 March Madness Predictions")
list.files("data")
files <- list.files("data")
myfiles = lapply(temp, read.csv)
myfiles = lapply(files, read.csv)
myfiles = lapply(paste0("data/",files), read.csv)
View(myfiles)
file_names <- list.files("data")
files <- lapply(paste0("data/",files), read.csv)
names(files) <- "A"
View(files)
library(tidyverse)
file_names <- list.files("data")
files <- lapply(paste0("data/",files), read.csv)
files <- lapply(paste0("data/",file_names), read.csv)
names(files) <- str_remove(file_names, ".csv")
View(files)
names(files$MTeams)
names(files$MNCAATourneySeeds)
mens_tournament_data <- merge(files$MTeams, files$MNCAATourneySeeds, by = "TeamID")
View(mens_tournament_data)
mens_tournament_data <- merge(files$MTeams, files$MNCAATourneySeeds, by = "TeamID") %>%
mutate(Seed = str_remove_all(Seed, "\\D"))
mens_tournament_data <- merge(files$MTeams, files$MNCAATourneySeeds, by = "TeamID") %>%
mutate(Seed = as.numeric(str_remove_all(Seed, "\\D")))
names(mens_tournament_data)
mens_tournament_data <- merge(files$MTeams, files$MNCAATourneySeeds, by = "TeamID") %>%
mutate(Seed = as.numeric(str_remove_all(Seed, "\\D"))) %>%
select(TeamID, TeamName, Season, Seed)
mens_seed_data <- merge(files$MTeams, files$MNCAATourneySeeds, by = "TeamID") %>%
mutate(Seed = as.numeric(str_remove_all(Seed, "\\D"))) %>%
select(TeamID, TeamName, Season, Seed)
View(mens_seed_data)
names(files$MNCAATourneyCompactResults)
mens_tourney_results <- merge(mens_seed_data, files$MNCAATourneyCompactResults, by.x = "TeamID", by.y = c("WTeamID, LTeamID"))
files$MNCAATourneyCompactResults %>% view
mens_tourney_results <- files$MNCAATourneyCompactResults %>%
select(Season, WTeamID, LTeamID)
View(mens_tourney_results)
mens_tourney_results_raw <- files$MNCAATourneyCompactResults %>%
select(Season, WTeamID, LTeamID)
mens_tourney_results <- rbind(data.frame(mens_tourney_results_raw[1:2] %>% mutate(result = 1)))
View(mens_tourney_results_raw)
mens_tourney_results <- rbind(data.frame(mens_tourney_results_raw[1:2] %>% rename(TeamID = WTeamID) %>% mutate(result = 1)))
mens_tourney_results <- rbind(data.frame(mens_tourney_results_raw[1:2] %>%
rename(TeamID = WTeamID) %>%
mutate(win = T)),
data.frame(mens_tourney_results_raw[c(1,3)] %>%
rename(TeamID = LTeamID) %>%
mutate(win = F)))
mens_tourney_results <- rbind(data.frame(mens_tourney_results_raw[1:2] %>%
rename(TeamID = WTeamID) %>%
mutate(win = T)),
data.frame(mens_tourney_results_raw[c(1,3)] %>%
rename(TeamID = LTeamID) %>%
mutate(win = F))) %>%
merge(mens_seed_data, by = "TeamID")
mens_tourney_results <- rbind(data.frame(mens_tourney_results_raw[1:2] %>%
rename(TeamID = WTeamID) %>%
mutate(win = T)),
data.frame(mens_tourney_results_raw[c(1,3)] %>%
rename(TeamID = LTeamID) %>%
mutate(win = F))) %>%
merge(mens_seed_data, by = c("Season","TeamID"))
mens_tourney_results_raw <- files$MNCAATourneyCompactResults %>%
merge(mens_seed_data, by.x = c("Season","WTeamID"), by.y = c("Season","TeamID"))
mens_tourney_results_raw <- files$MNCAATourneyCompactResults %>%
select(Season, WTeamID, LTeamID) %>%
merge(mens_seed_data, by.x = c("Season","WTeamID"), by.y = c("Season","TeamID"))
mens_tourney_results <- files$MNCAATourneyCompactResults %>%
select(Season, WTeamID, LTeamID) %>%
merge(mens_seed_data, by.x = c("Season","WTeamID"), by.y = c("Season","TeamID")) %>%
rename(WSeed = Seed) %>%
merge(mens_seed_data, by.x = c("Season","LTeamID"), by.y = c("Season","TeamID")) %>%
rename(LSeed = Seed)
mens_tourney_results <- files$MNCAATourneyCompactResults %>%
select(Season, WTeamID, LTeamID) %>%
merge(mens_seed_data, by.x = c("Season","WTeamID"), by.y = c("Season","TeamID")) %>%
rename(WSeed = Seed) %>%
merge(mens_seed_data, by.x = c("Season","LTeamID"), by.y = c("Season","TeamID")) %>%
rename(LSeed = Seed) %>%
mutate(seed_diff = WSeed - LSeed)
mens_tourney_results <- files$MNCAATourneyCompactResults %>%
select(Season, WTeamID, LTeamID) %>%
merge(mens_seed_data, by.x = c("Season","WTeamID"), by.y = c("Season","TeamID")) %>%
rename(WSeed = Seed) %>%
merge(mens_seed_data, by.x = c("Season","LTeamID"), by.y = c("Season","TeamID")) %>%
rename(LSeed = Seed) %>%
mutate(seed_diff = LSeed - WSeed)
mens_tourney_results <- files$MNCAATourneyCompactResults %>%
select(Season, WTeamID, LTeamID) %>%
merge(mens_seed_data, by.x = c("Season","WTeamID"), by.y = c("Season","TeamID")) %>%
rename(WSeed = Seed) %>%
merge(mens_seed_data, by.x = c("Season","LTeamID"), by.y = c("Season","TeamID")) %>%
rename(LSeed = Seed) %>%
mutate(win = ifelse(WSeed == LSeed, WTeamID > LTeamID, WSeed > LSeed),
seed_diff = abs(LSeed - WSeed))
mens_tourney_results <- files$MNCAATourneyCompactResults %>%
select(Season, WTeamID, LTeamID) %>%
merge(mens_seed_data, by.x = c("Season","WTeamID"), by.y = c("Season","TeamID")) %>%
rename(WSeed = Seed,
WTeamName = TeamName) %>%
merge(mens_seed_data, by.x = c("Season","LTeamID"), by.y = c("Season","TeamID")) %>%
rename(LSeed = Seed,
LTeamName = TeamName) %>%
mutate(win = ifelse(WSeed == LSeed, WTeamID > LTeamID, WSeed > LSeed),
seed_diff = abs(LSeed - WSeed))
mens_tourney_results <- files$MNCAATourneyCompactResults %>%
select(Season, WTeamID, LTeamID) %>%
merge(mens_seed_data, by.x = c("Season","WTeamID"), by.y = c("Season","TeamID")) %>%
rename(WSeed = Seed,
WTeamName = TeamName) %>%
merge(mens_seed_data, by.x = c("Season","LTeamID"), by.y = c("Season","TeamID")) %>%
rename(LSeed = Seed,
LTeamName = TeamName) %>%
mutate(win = ifelse(WSeed == LSeed, WTeamID > LTeamID, WSeed < LSeed),
seed_diff = abs(LSeed - WSeed))
seed_model <- glm(win ~ seed_diff, data = mens_tourney_results)
seed_model
seed_model %>% summary()
mens_tourney_train <- mens_tourney_results %>%
filter(Season %in% c(2017, 2018, 2019, 2021, 2022))
mens_tourney_test <- mens_tourney_results %>%
filter(!Season %in% c(2017, 2018, 2019, 2021, 2022))
seed_model <- glm(win ~ seed_diff, data = mens_tourney_results_train)
seed_model <- glm(win ~ seed_diff, data = mens_tourney_train)
?glm
seed_model <- glm(win ~ seed_diff, data = mens_tourney_train, family = "binomial")
mens_tourney_test$predict <- predict(seed_model, type = "response")
seed_model <- glm(win ~ seed_diff, data = mens_tourney_train, family = "binomial")
mens_tourney_test$predict <- predict(mens_tourney_test, seed_model, type = "response")
mens_tourney_test$predict <- predict(seed_model, mens_tourney_test, type = "response")
View(mens_tourney_test)
mens_tourney_test <- mens_tourney_results %>%
filter(Season %in% c(2017, 2018, 2019, 2021, 2022))
mens_tourney_train <- mens_tourney_results %>%
filter(!(Season %in% c(2017, 2018, 2019, 2021, 2022)))
seed_model <- glm(win ~ seed_diff, data = mens_tourney_train, family = "binomial")
mens_tourney_test$predict <- predict(seed_model, mens_tourney_test, type = "response")
View(mens_tourney_test)
files$SampleSubmission2023 %>% view()
mens_submission <- mens_tourney_test %>%
mutate(ID = paste0(Season,WTeamID,LTeamID,collapse = "-"))
View(mens_submission)
mens_submission <- mens_tourney_test %>%
mutate(ID = paste0(Season,WTeamID,LTeamID))
mens_submission <- mens_tourney_test %>%
mutate(ID = paste0(Season,"-",WTeamID,"-",LTeamID))
View(mens_submission)
mens_submission <- mens_tourney_test %>%
mutate(ID = paste0(Season,"-",WTeamID,"-",LTeamID)) %>%
select(ID, Pred)
mens_tourney_test <- mens_tourney_results %>%
filter(Season %in% c(2017, 2018, 2019, 2021, 2022))
mens_tourney_train <- mens_tourney_results %>%
filter(!(Season %in% c(2017, 2018, 2019, 2021, 2022)))
seed_model <- glm(win ~ seed_diff, data = mens_tourney_train, family = "binomial")
mens_tourney_test$Pred <- predict(seed_model, mens_tourney_test, type = "response")
mens_submission <- mens_tourney_test %>%
mutate(ID = paste0(Season,"-",WTeamID,"-",LTeamID)) %>%
select(ID, Pred)
View(mens_submission)
